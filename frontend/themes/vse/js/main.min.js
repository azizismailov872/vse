function sendMessage(e,o){$.ajax({url:e,data:o,type:"POST",dataType:"json",success:function(e){if(console.log(e),1==e.result){let e=$(".popup.success");$(".popup.success .success-header").text(function(e){return"Сообщение успешно отправлено"}),openPopup($(e)),setTimeout(function(){closePopup($(e))},5e3),$("#write-message-form textarea").val("")}},error:function(e){console.log(e)}})}function openOrder(e){let o="/order/view/"+$(e).attr("id");window.location.href=o}function openMessage(e){let o="/profile/message/"+$(e).attr("id");window.location.href=o}function activeBurgerMenu(e){$(e).toggleClass("active"),$(".sidebar").toggleClass("open"),$(".sidebar-wrap").toggleClass("open"),$("body").toggleClass("lock")}function lockPadding(e){$(".main").css("padding-right",e),$(".header").css("padding-right",e),$(".category").css("padding-right",e),$("body").addClass("lock")}function unlockPadding(){$(".main").css("padding-right",0),$(".header").css("padding-right",0),$(".category").css("padding-right",0),$("body").removeClass("lock")}function closeSidebar(){$(".sidebar").removeClass("open"),$(".sidebar-wrap").removeClass("open"),$(".burger-btn").removeClass("active"),$("body").removeClass("lock")}function make_action(e,o,t){null!==o&&$.ajax({url:e,data:o,type:"POST",dataType:"json",success:function(e){null!==t?($.pjax.defaults.timeout=3e3,$.pjax.reload({container:t}),null!==e&&console.log(e.msg)):null!==e&&console.log(e.msg)},error:function(e){console.log(e.msg)}})}function fileCount(){let e=document.querySelectorAll(".input__file");Array.prototype.forEach.call(e,function(e){let o=$(e).siblings(".button"),t=o.innerText;e.addEventListener("change",function(e){let n="";this.files&&this.files.length>=1&&(n=this.files.length),n?$(o).text(function(e){return"Выбрано файлов: "+n}):$(o).text(function(e){return t})})})}function takePayment(e){let o=$(e).closest(".order").attr("id");$.ajax({url:"/order/pay",data:{id:o},type:"POST",dataType:"json",success:function(e){e&&console.log(e)},error:function(e){e&&console.log(e)}})}function openPopup(e){let o=$(".popup.open");o&&closePopup(o),e&&(lockPadding(lockPaddingValue),$(e).addClass("open"),$(e).fadeIn("fast"))}function closePopup(e){if(e.length>0){for(let o=0;o<e.length;o++)$(e[o]).fadeOut("fast"),setTimeout(function(){$(e[o]).removeClass("open")},500);unlockPadding()}}function saveOrder(e,o,t){$.ajax({url:e,data:o,type:"POST",dataType:"json",success:function(e){1==e.result?(openPopup($(".popup.success")),$.pjax.defaults.timeout=3e3,$.pjax.reload({container:t}),setTimeout(function(){closePopup($(".popup.success"))},5e3),$("#create-order-form textarea").val(""),$("#create-order-form select").val(""),$("#orders-list").on("pjax:end",function(e){let o=$(e.target).find(".order");if(o.length>0)for(let e=0;e<=1;e++)$(o[0]).addClass("new"),setTimeout(function(){$(o[0]).removeClass("new")},6e3)})):console.log(e.msg)},error:function(e){console.log(e)}})}let lockPaddingValue=window.innerWidth-document.querySelector(".wrap").offsetWidth+"px";$(document).ready(function(){let e=$("#success-alert"),o=$("#error-alert");(e.length>0||o.length>0)&&setTimeout(function(){$.pjax.reload({container:"#alerts"})},1500),$(".categories-link").click(function(){setTimeout(function(){$(".sidebar").removeClass("open"),$(".sidebar-wrap").removeClass("open"),$(".burger-btn").removeClass("active"),$("body").hasClass("lock")&&$("body").removeClass("lock")},500)}),$(".sidebar-menu-link").click(function(){setTimeout(function(){$(".sidebar").removeClass("open"),$(".sidebar-wrap").removeClass("open"),$(".burger-btn").removeClass("active"),$("body").hasClass("lock")&&$("body").removeClass("lock")},500)}),$(".sidebar-wrap").click(function(){$(".sidebar").removeClass("open"),$(".sidebar-wrap").removeClass("open"),$(".burger-btn").removeClass("active"),$("body").hasClass("lock")&&$("body").removeClass("lock")}),$(".mask").inputmask({mask:"+\\9\\9\\6(999)999-999"}),$("#up-to-top").click(function(){$("body,html").animate({scrollTop:0},700)}),$(window).scroll(function(){$(this).scrollTop()>80?$("#up-to-top").addClass("active"):$("#up-to-top").removeClass("active")}),$(".delete-photo-btn").click(function(){id=$(this).attr("id"),data={id:id},url="/profile/delete-image",grid_id="#user-photo",make_action(url,data,grid_id)}),$("#no-active").click(function(){openPopup($(".popup.no-active")),setTimeout(function(){closePopup($(".popup.no-active"))},5e3)}),fileCount(),$(".popup-open").click(function(e){e.preventDefault();let o="."+$(this).attr("id");openPopup($(o))}),$(".popup-close").click(function(){closePopup($(this).closest(".popup.open")),$("body").hasClass("lock")&&$("body").removeClass("lock")}),$(".popup").click(function(e){0==$(e.target).closest(".popup-content").length&&closePopup($(this))}),$("#create-order-form").on("afterValidate",function(e,o,t){let n=!0;t.map(function(e){console.log(e.name),"author_phone"==e.name&&(n=!1)}),$("#create-order-btn").click(function(){1==n&&closePopup($(".popup.new-order"))})}),$("#create-order-form").on("beforeSubmit",function(){return saveOrder("/order/save",$(this).serialize(),"#orders-list-pjax"),!1}),$("#write-message-form").on("beforeSubmit",function(){return sendMessage("/message/send",$(this).serialize()),!1})});